LOAD EMPLOYEE
employeecross <- CROSS EMPLOYEE EMPLOYEE
Q1_temp <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM employeecross
Q1_temp2 <- SELECT EMPLOYEE1_Dno != EMPLOYEE2_Dno FROM Q1_temp
Q1 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE1_Dno, EMPLOYEE2_Ssn, EMPLOYEE2_Dno FROM Q1_temp2
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q1
RENAME EMPLOYEE1_Dno TO Dno FROM Q1
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q1
RENAME EMPLOYEE2_Dno TO Super_dno FROM Q1

LOAD PROJECT
LOAD WORKS_ON
TEMPCROSS <- CROSS EMPLOYEE WORKS_ON
CROSS <- CROSS TEMPCROSS PROJECT
Q2_temp <- SELECT Pno == Pnumber FROM CROSS
Q2_temp2 <- SELECT Ssn == Essn FROM Q2_temp
Q2_temp3 <- SELECT Dno == Dnum FROM Q2_temp2
Q2 <- PROJECT Ssn, Dno, Pno, Dnum FROM Q2_temp3
RENAME Dnum TO P_dno FROM Q2

Q3_temp <- SELECT Dno != Dnum FROM Q2_temp2
Q3 <- PROJECT Ssn, Dno, Pno, Dnum FROM Q3_temp
RENAME Dnum TO P_dno FROM Q3

Q4_temp <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM employeecross
Q4_temp2 <- SELECT EMPLOYEE1_Bdate < EMPLOYEE2_Bdate FROM Q4_temp
Q4 <- PROJECT EMPLOYEE1_Super_ssn, EMPLOYEE2_Bdate, EMPLOYEE1_Ssn, EMPLOYEE1_Bdate FROM Q4_temp2
RENAME EMPLOYEE1_Super_ssn TO Super_ssn FROM Q4
RENAME EMPLOYEE2_Bdate TO Super_bdate FROM Q4
RENAME EMPLOYEE1_Ssn TO Essn FROM Q4
RENAME EMPLOYEE1_Bdate TO E_bdate FROM Q4

Q5_temp <- SELECT EMPLOYEE1_Sex == 1 FROM employeecross
Q5_temp2 <- SELECT EMPLOYEE2_Sex == 0 FROM employeecross
Q5_temp3 <- SELECT EMPLOYEE1_Dno == EMPLOYEE2_Dno FROM employeecross
Q5 <- PROJECT EMPLOYEE1_Dno FROM Q5_temp3
RENAME EMPLOYEE1_Dno TO DNO FROM Q5

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT
